<!DOCTYPE html>
<html>
<head>
  <title>Knitting Row Counter - Continuous Voice</title>
</head>
<body>
  <h2>Knitting Row Counter</h2>
  <p id="rowDisplay">Row: 0</p>
  <button onclick="nextRow()">Next Row</button>
  <button onclick="backRow()">Back</button>
  <button onclick="resetCounter()">Reset</button>
  <button onclick="startListening()">ðŸŽ¤ Start Voice Control</button>
  <button onclick="stopListening()">ðŸ›‘ Stop Voice Control</button>

  <script>
    let row = 0;
    let recognition;

    function updateDisplay() {
      document.getElementById("rowDisplay").innerText = "Row: " + row;
    }

    function speak(text) {
      const utterance = new SpeechSynthesisUtterance(text);
      speechSynthesis.speak(utterance);
    }

    function nextRow() {
      row++;
      updateDisplay();
      speak("Row " + row + " started");
    }

    function backRow() {
      if (row > 0) row--;
      updateDisplay();
      speak("Back to row " + row);
    }

    function resetCounter() {
      row = 0;
      updateDisplay();
      speak("Counter reset to row zero");
    }

    function startListening() {
      recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
      recognition.lang = "en-GB";
      recognition.continuous = true; // keeps listening
      recognition.onresult = function(event) {
        const command = event.results[event.results.length - 1][0].transcript.toLowerCase();
        if (command.includes("next")) nextRow();
        else if (command.includes("back")) backRow();
        else if (command.includes("reset")) resetCounter();
      };
      recognition.start();
      speak("Voice control started");
    }

    function stopListening() {
      if (recognition) {
        recognition.stop();
        speak("Voice control stopped");
      }
    }
  </script>
</body>
</html>

